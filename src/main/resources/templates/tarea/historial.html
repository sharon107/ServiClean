<!DOCTYPE html>
<html lang="es"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="layouts/_mainLayout">

<div layout:fragment="content">
    <div class="container py-5">
        <!-- Encabezado -->
        <div class="page-header text-center mb-5">
            <h1 class="main-title text-success">
                <i class="fas fa-history me-3"></i>
                Historial de Tareas
            </h1>
            <div class="title-underline bg-success"></div>
            <p class="page-subtitle text-success">Registro completo de todas las tareas creadas y modificadas</p>
        </div>

        <!-- Tarjetas de resumen (opcional) -->
        <div class="row g-4 mb-4">
            <div class="col-md-4">
                <div class="modern-card text-center p-4">
                    <h5>Total de Tareas</h5>
                    <p th:text="${tareas.size()}">0</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="modern-card text-center p-4">
                    <h5>Tareas Pendientes</h5>
                    <p th:text="${#lists.size(tareas.?[estado == 'Pendiente'])}">0</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="modern-card text-center p-4">
                    <h5>Tareas Completadas</h5>
                    <p th:text="${#lists.size(tareas.?[estado == 'Completada'])}">0</p>
                </div>
            </div>
        </div>

        <!-- Tabla de historial -->
        <div class="modern-card form-card">
            <div class="card-glow"></div>
            <div class="table-responsive">
                <table class="table table-hover align-middle">
                    <thead class="table-success text-success">
                    <tr>
                        <th>ID</th>
                        <th>Título</th>
                        <th>Equipo</th>
                        <th>Estado</th>
                        <th>Fecha Asignación</th>
                        <th>Fecha Modificación</th>
                        <th>Acciones</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="tarea : ${tareas}">
                        <td th:text="${tarea.id}"></td>
                        <td th:text="${tarea.titulo}"></td>
                        <td th:text="${tarea.equipo != null ? tarea.equipo.nombreEquipo : 'Sin equipo'}"></td>
                        <td th:text="${tarea.estado}"></td>
                        <td th:text="${tarea.fechaAsignacion}"></td>
                        <td th:text="${tarea.fechaModificacion}"></td>
                        <td>
                            <a th:href="@{/tareas/details/{id}(id=${tarea.id})}" class="btn btn-sm btn-success me-2">
                                <i class="fas fa-eye"></i> Ver
                            </a>
                            <a th:href="@{/tareas/edit/{id}(id=${tarea.id})}" class="btn btn-sm btn-primary me-2">
                                <i class="fas fa-edit"></i> Editar
                            </a>
                            <a th:href="@{/tareas/delete/{id}(id=${tarea.id})}" class="btn btn-sm btn-danger">
                                <i class="fas fa-trash-alt"></i> Eliminar
                            </a>
                        </td>
                    </tr>
                    <tr th:if="${#lists.isEmpty(tareas)}">
                        <td colspan="7" class="text-center text-muted">No hay tareas registradas.</td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <!-- Botón regresar -->
            <div class="text-end mt-4">
                <a th:href="@{/tareas}" class="btn-modern btn-secondary-modern">
                    <i class="fas fa-arrow-left me-2"></i>Regresar
                </a>
            </div>
        </div>
    </div>

    <!-- Estilos adaptados -->
    <style>
        .modern-card { background: rgba(255,255,255,0.95); border-radius: 25px; padding: 2rem; box-shadow: 0 15px 35px rgba(0,0,0,0.1); position: relative; transition: all 0.3s ease; }
        .modern-card:hover { box-shadow: 0 25px 50px rgba(0,0,0,0.15); transform: translateY(-5px); }
        .card-glow { position: absolute; top: -2px; left: -2px; right: -2px; bottom: -2px; background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); border-radius: 25px; opacity: 0; transition: opacity 0.3s ease; }
        .modern-card:hover .card-glow { opacity: 0.1; }
        .table-hover tbody tr:hover { background-color: rgba(72, 239, 157, 0.1); }
        .btn-modern { border-radius: 50px; text-transform: uppercase; font-weight: 600; transition: all 0.3s ease; }
        .btn-secondary-modern { background: rgba(108,117,125,0.1); color: #6c757d; border: 2px solid rgba(108,117,125,0.2); }
        .btn-secondary-modern:hover { background: rgba(108,117,125,0.2); transform: translateY(-3px); }
    </style>
</div>
</html>
